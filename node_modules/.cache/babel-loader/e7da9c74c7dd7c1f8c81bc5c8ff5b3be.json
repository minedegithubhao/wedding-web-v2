{"remainingRequest":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/babel-loader/lib/index.js!/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/eslint-loader/index.js??ref--13-0!/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/src/store/modules/user.js","dependencies":[{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/src/store/modules/user.js","mtime":1605568762439},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCB7IGxvZ2luLCBnZXRJbmZvLCBsb2dvdXQgfSBmcm9tICdAL2FwaS9sb2dpbic7CmltcG9ydCB7IEFDQ0VTU19UT0tFTiB9IGZyb20gJ0Avc3RvcmUvbXV0YXRpb24tdHlwZXMnOwppbXBvcnQgeyB3ZWxjb21lIH0gZnJvbSAnQC91dGlscy91dGlsJzsKdmFyIHVzZXIgPSB7CiAgc3RhdGU6IHsKICAgIHVzZXJJZDogJycsCiAgICB0b2tlbjogJycsCiAgICBuYW1lOiAnJywKICAgIHdlbGNvbWU6ICcnLAogICAgYXZhdGFyOiAnJywKICAgIHJvbGVzOiBbXSwKICAgIGJ1dHRvbnM6IFtdLAogICAgLy8g5oyJ6ZKu5p2D6ZmQCiAgICBpbmZvOiB7fQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBTRVRfVE9LRU46IGZ1bmN0aW9uIFNFVF9UT0tFTihzdGF0ZSwgdG9rZW4pIHsKICAgICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICAgIH0sCiAgICBTRVRfTkFNRTogZnVuY3Rpb24gU0VUX05BTUUoc3RhdGUsIF9yZWYpIHsKICAgICAgdmFyIG5hbWUgPSBfcmVmLm5hbWUsCiAgICAgICAgICB3ZWxjb21lID0gX3JlZi53ZWxjb21lOwogICAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICAgICAgc3RhdGUud2VsY29tZSA9IHdlbGNvbWU7CiAgICB9LAogICAgU0VUX0FWQVRBUjogZnVuY3Rpb24gU0VUX0FWQVRBUihzdGF0ZSwgYXZhdGFyKSB7CiAgICAgIHN0YXRlLmF2YXRhciA9IGF2YXRhcjsKICAgIH0sCiAgICBTRVRfUk9MRVM6IGZ1bmN0aW9uIFNFVF9ST0xFUyhzdGF0ZSwgcm9sZXMpIHsKICAgICAgc3RhdGUucm9sZXMgPSByb2xlczsKICAgIH0sCiAgICBTRVRfSU5GTzogZnVuY3Rpb24gU0VUX0lORk8oc3RhdGUsIGluZm8pIHsKICAgICAgc3RhdGUuaW5mbyA9IGluZm87CiAgICB9LAogICAgU0VUX0JVVFRPTlM6IGZ1bmN0aW9uIFNFVF9CVVRUT05TKHN0YXRlLCBidXR0b25zKSB7CiAgICAgIHN0YXRlLmJ1dHRvbnMgPSBidXR0b25zOwogICAgfSwKICAgIFNFVF9VU0VSSUQ6IGZ1bmN0aW9uIFNFVF9VU0VSSUQoc3RhdGUsIHVzZXJJZCkgewogICAgICBzdGF0ZS51c2VySWQgPSB1c2VySWQ7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICAvLyDnmbvlvZUKICAgIExvZ2luOiBmdW5jdGlvbiBMb2dpbihfcmVmMiwgdXNlckluZm8pIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBsb2dpbih1c2VySW5mbykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSByZXNwb25zZTsKICAgICAgICAgIFZ1ZS5scy5zZXQoQUNDRVNTX1RPS0VOLCByZXN1bHQudG9rZW4sIDEyICogNjAgKiA2MCAqIDEwMDApOwogICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCByZXN1bHQudG9rZW4pOwogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDojrflj5bnlKjmiLfkv6Hmga8KICAgIEdldEluZm86IGZ1bmN0aW9uIEdldEluZm8oX3JlZjMpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBnZXRJbmZvKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSByZXNwb25zZTsKCiAgICAgICAgICBpZiAocmVzdWx0LnJvbGVJZHMpIHsKICAgICAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCByZXN1bHQucm9sZUlkcyk7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX0JVVFRPTlMnLCByZXN1bHQuYnV0dG9ucyk7CiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1VTRVJJRCcsIHJlc3VsdC51c2VySWQpOwogICAgICAgICAgICBjb21taXQoJ1NFVF9JTkZPJywgcmVzdWx0KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ2dldEluZm86IHJvbGVzIG11c3QgYmUgYSBub24tbnVsbCBhcnJheSAhJykpOwogICAgICAgICAgfSAvLyBjb25zb2xlLmxvZyhyZXN1bHQpCgoKICAgICAgICAgIGNvbW1pdCgnU0VUX05BTUUnLCB7CiAgICAgICAgICAgIG5hbWU6IHJlc3VsdC51c2VyTmFtZSwKICAgICAgICAgICAgd2VsY29tZTogd2VsY29tZSgpCiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIHJlc3VsdC5hdmF0YXIgfHwgJy9sb2dvLnBuZycpOwogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDnmbvlh7oKICAgIExvZ291dDogZnVuY3Rpb24gTG9nb3V0KF9yZWY0KSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQsCiAgICAgICAgICBzdGF0ZSA9IF9yZWY0LnN0YXRlOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBsb2dvdXQoc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgJycpOwogICAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCBbXSk7CiAgICAgICAgICBjb21taXQoJ1NFVF9JTkZPJywge30pOwogICAgICAgICAgVnVlLmxzLnJlbW92ZShBQ0NFU1NfVE9LRU4pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9Cn07CmV4cG9ydCBkZWZhdWx0IHVzZXI7"},{"version":3,"sources":["/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/src/store/modules/user.js"],"names":["Vue","login","getInfo","logout","ACCESS_TOKEN","welcome","user","state","userId","token","name","avatar","roles","buttons","info","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_INFO","SET_BUTTONS","SET_USERID","actions","Login","userInfo","commit","Promise","resolve","reject","then","response","result","ls","set","catch","error","GetInfo","roleIds","Error","userName","Logout","finally","remove"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport { login, getInfo, logout } from '@/api/login'\nimport { ACCESS_TOKEN } from '@/store/mutation-types'\nimport { welcome } from '@/utils/util'\n\nconst user = {\n  state: {\n    userId: '',\n    token: '',\n    name: '',\n    welcome: '',\n    avatar: '',\n    roles: [],\n    buttons: [], // 按钮权限\n    info: {}\n  },\n\n  mutations: {\n    SET_TOKEN: (state, token) => {\n      state.token = token\n    },\n    SET_NAME: (state, { name, welcome }) => {\n      state.name = name\n      state.welcome = welcome\n    },\n    SET_AVATAR: (state, avatar) => {\n      state.avatar = avatar\n    },\n    SET_ROLES: (state, roles) => {\n      state.roles = roles\n    },\n    SET_INFO: (state, info) => {\n      state.info = info\n    },\n    SET_BUTTONS: (state, buttons) => {\n      state.buttons = buttons\n    },\n    SET_USERID: (state, userId) => {\n      state.userId = userId\n    }\n  },\n\n  actions: {\n    // 登录\n    Login ({ commit }, userInfo) {\n      return new Promise((resolve, reject) => {\n        login(userInfo).then(response => {\n          const result = response\n          Vue.ls.set(ACCESS_TOKEN, result.token, 12 * 60 * 60 * 1000)\n          commit('SET_TOKEN', result.token)\n          resolve(response)\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    },\n\n    // 获取用户信息\n    GetInfo ({ commit }) {\n      return new Promise((resolve, reject) => {\n        getInfo().then(response => {\n          const result = response\n          if (result.roleIds) {\n            commit('SET_ROLES', result.roleIds)\n            commit('SET_BUTTONS', result.buttons)\n            commit('SET_USERID', result.userId)\n            commit('SET_INFO', result)\n          } else {\n            reject(new Error('getInfo: roles must be a non-null array !'))\n          }\n          // console.log(result)\n          commit('SET_NAME', { name: result.userName, welcome: welcome() })\n          commit('SET_AVATAR', result.avatar || '/logo.png')\n          resolve(response)\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    },\n\n    // 登出\n    Logout ({ commit, state }) {\n      return new Promise((resolve) => {\n        logout(state.token).then(() => {\n          resolve()\n        }).catch(() => {\n          resolve()\n        }).finally(() => {\n          commit('SET_TOKEN', '')\n          commit('SET_ROLES', [])\n          commit('SET_INFO', {})\n          Vue.ls.remove(ACCESS_TOKEN)\n        })\n      })\n    }\n\n  }\n}\n\nexport default user\n"]}]}