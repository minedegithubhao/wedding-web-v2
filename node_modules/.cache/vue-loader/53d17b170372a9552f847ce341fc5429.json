{"remainingRequest":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/src/views/system/modules/SysTopMenuModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/src/views/system/modules/SysTopMenuModal.vue","mtime":1605568762478},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldFBlcm1pc3Npb25zLCBnZXRNZW51UGVybUlkcywgc2F2ZVN5c1RvcE1lbnUgfSBmcm9tICdAL2FwaS9zeXN0ZW0nCmltcG9ydCBwaWNrIGZyb20gJ2xvZGFzaC5waWNrJwppbXBvcnQgeyBnZXREaWN0QXJyYXkgfSBmcm9tICdAL3V0aWxzL2RpY3QnCmltcG9ydCBTVXBsb2FkIGZyb20gJ0AvY29tcG9uZW50cy9wdHMvVXBsb2FkJwppbXBvcnQgVmVudXNTY3JvbGwgZnJvbSAnQC9jb21wb25lbnRzL3B0cy9TY3JvbGwnCmltcG9ydCBEZXRhaWxMaXN0IGZyb20gJ0AvY29tcG9uZW50cy90b29scy9EZXRhaWxMaXN0Jwpjb25zdCBEZXRhaWxMaXN0SXRlbSA9IERldGFpbExpc3QuSXRlbQoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTeXNUb3BNZW51TW9kYWwnLAogIHByb3BzOiB7fSwKICBjb21wb25lbnRzOiB7CiAgICBTVXBsb2FkLAogICAgRGV0YWlsTGlzdCwKICAgIERldGFpbExpc3RJdGVtLAogICAgVmVudXNTY3JvbGwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgbGFiZWxDb2w6IHsKICAgICAgICB4czogeyBzcGFuOiAyNCB9LAogICAgICAgIHNtOiB7IHNwYW46IDYgfQogICAgICB9LAogICAgICB3cmFwcGVyQ29sOiB7CiAgICAgICAgeHM6IHsgc3BhbjogMjQgfSwKICAgICAgICBzbTogeyBzcGFuOiAxOCB9CiAgICAgIH0sCiAgICAgIGNvbmZpcm1Mb2FkaW5nOiBmYWxzZSwKICAgICAgbWRsOiB7fSwKICAgICAgbGF5b3V0TW9kZUFycnk6IFtdLAogICAgICB2aXNpYmxlQXJyeTogW10sCiAgICAgIGZvcm06IHRoaXMuJGZvcm0uY3JlYXRlRm9ybSh0aGlzKSwKICAgICAgcGVybWlzc2lvbnM6IFtdLAogICAgICB0cmVlQ2hlY2s6IGZhbHNlLAogICAgICBwaWRTZXQ6IFtdLAogICAgICBjaGVja2VkS2V5czogW10sCiAgICAgIGhhbGZDaGVja2VkS2V5czogW10sCiAgICAgIGxheW91dE1vZGU6ICcnCiAgICB9CiAgfSwKICBiZWZvcmVDcmVhdGUoKSB7IH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIHRoaXMubGF5b3V0TW9kZUFycnkgPSBhd2FpdCBnZXREaWN0QXJyYXkoJ2xheW91dF9tb2RlJykKICAgIHRoaXMudmlzaWJsZUFycnkgPSBhd2FpdCBnZXREaWN0QXJyYXkoJ3N5c19zaG93X2hpZGUnKQogICAgdGhpcy5sb2FkUGVybWlzc2lvbnMoKQogIH0sCiAgbWV0aG9kczogewogICAgbGF5b3V0TW9kZUNoYW5nZSh2YWx1ZSkgewogICAgICB0aGlzLmxheW91dE1vZGUgPSB2YWx1ZQogICAgICBpZiAodmFsdWUgPT09ICd0b3BtZW51JykgewogICAgICAgIHRoaXMuZm9ybS5zZXRGaWVsZHNWYWx1ZSh7IG11bHRpVGFiOiBmYWxzZSB9KQogICAgICB9CiAgICB9LAogICAgYWRkKCkgewogICAgICB0aGlzLmZvcm0ucmVzZXRGaWVsZHMoKQogICAgICB0aGlzLmNoZWNrZWRLZXlzID0gW10KICAgICAgdGhpcy5waWRTZXQgPSBbXQogICAgICB0aGlzLmVkaXQoeyBpZDogMCB9KQogICAgfSwKICAgIGVkaXQocmVjb3JkKSB7CiAgICAgIHRoaXMubGF5b3V0TW9kZSA9ICcnCiAgICAgIGlmIChyZWNvcmQuaWQgIT09IDApIHsKICAgICAgICBnZXRNZW51UGVybUlkcyhyZWNvcmQuaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGNvbnN0IHBpZFNldCA9IG5ldyBTZXQocmVzLm1hcChtID0+IG0ucGFyZW50SWQpLmZpbHRlcihpZCA9PiBpZCA+IDApKQogICAgICAgICAgdGhpcy5waWRTZXQgPSBwaWRTZXQKICAgICAgICAgIC8vIOWboOS4umFudGQg5qCR5o+S5Lu25Yu+6YCJ54i26IqC54K55Lya5a+86Ie05omA5pyJ5a2Q6IqC54K56YCJ5LitLOaJgOS7pei/h+a7pOaJgOacieeItuiKgueCuQogICAgICAgICAgdGhpcy5jaGVja2VkS2V5cyA9IHJlcy5tYXAobSA9PiBtLm1lbnVJZCkuZmlsdGVyKGlkID0+ICFwaWRTZXQuaGFzKGlkKSkKICAgICAgICB9KQogICAgICB9CiAgICAgIHRoaXMubWRsID0gT2JqZWN0LmFzc2lnbihyZWNvcmQpCiAgICAgIHRoaXMubWRsLm11bHRpVGFiID0gdGhpcy5tZGwubXVsdGlUYWIgPT09ICd0cnVlJyB8fCB0aGlzLm1kbC5tdWx0aVRhYiA9PT0gdHJ1ZSB8fCB0aGlzLm1kbC5tdWx0aVRhYiA9PT0gdW5kZWZpbmVkCiAgICAgIHRoaXMubWRsLmFzc2lnbmVkSWQgPSB0aGlzLm1kbC5idXNJZCB8fCBudWxsCiAgICAgIHRoaXMudHJlZUNoZWNrID0gZmFsc2UKICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy5mb3JtLnNldEZpZWxkc1ZhbHVlKAogICAgICAgICAgcGljaygKICAgICAgICAgICAgdGhpcy5tZGwsCiAgICAgICAgICAgICdpZCcsCiAgICAgICAgICAgICdjb2RlJywKICAgICAgICAgICAgJ25hbWUnLAogICAgICAgICAgICAnY29tcG9uZW50JywKICAgICAgICAgICAgJ3NvdXJjZScsCiAgICAgICAgICAgICd0YXJnZXQnLAogICAgICAgICAgICAvLyAncGVybXMnLAogICAgICAgICAgICAnaWNvbicsCiAgICAgICAgICAgICdyZWRpcmVjdCcsCiAgICAgICAgICAgICd2aXNpYmxlJywKICAgICAgICAgICAgJ2xheW91dE1vZGUnLAogICAgICAgICAgICAnbXVsdGlUYWInLAogICAgICAgICAgICAnb3JkZXJOdW0nLAogICAgICAgICAgICAnYXNzaWduZWRJZCcKICAgICAgICAgICkKICAgICAgICApCiAgICAgIH0pCiAgICB9LAogICAgdmFsaWRhdGVQYXRoVGFyZ2V0KHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgewogICAgICBjb25zdCByZWRpcmVjdCA9IHRoaXMuZm9ybS5nZXRGaWVsZFZhbHVlKCdyZWRpcmVjdCcpCiAgICAgIGlmIChyZWRpcmVjdCAmJiByZWRpcmVjdC5zdGFydHNXaXRoKCdodHRwJykgJiYgdmFsdWUgIT09ICdfYmxhbmsnKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfpk77mjqXlnLDlnYDkuLrlpJbpk77ml7bvvIzmiZPlvIDmlrnlvI/lv4XpobvkuLrmlrDnqpflj6PvvIhhbnRk6ZmQ5Yi277yJJykpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKQogICAgICB9CiAgICB9LAogICAgb25DaGVjayhjaGVja2VkS2V5cywgaW5mbykgewogICAgICBpZiAoIXRoaXMudHJlZUNoZWNrKSB0aGlzLnRyZWVDaGVjayA9IHRydWUKICAgICAgdGhpcy5jaGVja2VkS2V5cyA9IGNoZWNrZWRLZXlzCiAgICAgIHRoaXMuaGFsZkNoZWNrZWRLZXlzID0gaW5mby5oYWxmQ2hlY2tlZEtleXMKICAgIH0sCiAgICBsb2FkUGVybWlzc2lvbnMoKSB7CiAgICAgIGdldFBlcm1pc3Npb25zKCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMuYnVpbGR0cmVlKHJlcy5yb3dzLCB0aGlzLnBlcm1pc3Npb25zLCAwKQogICAgICB9KQogICAgfSwKICAgIGJ1aWxkdHJlZShsaXN0LCBwZXJtaXNzaW9ucywgcGFyZW50SWQpIHsKICAgICAgbGlzdC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgIGlmIChpdGVtLnBhcmVudElkID09PSBwYXJlbnRJZCkgewogICAgICAgICAgdmFyIGNoaWxkID0gewogICAgICAgICAgICBrZXk6IGl0ZW0ubWVudUlkLAogICAgICAgICAgICB0aXRsZTogaXRlbS5tZW51TmFtZSwKICAgICAgICAgICAgY2hpbGRyZW46IFtdCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmJ1aWxkdHJlZShsaXN0LCBjaGlsZC5jaGlsZHJlbiwgaXRlbS5tZW51SWQpCiAgICAgICAgICBwZXJtaXNzaW9ucy5wdXNoKGNoaWxkKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICB1cGxvYWRTdWNjZXNzKHJlcykgewogICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZmlsZVBhdGgpCiAgICAgIHRoaXMuZm9ybS5zZXRGaWVsZHNWYWx1ZSh7IGljb246IHJlcy5maWxlUGF0aCB9KQogICAgfSwKICAgIGhhbmRsZVN1Ym1pdChlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKQogICAgICBjb25zdCBfdGhpcyA9IHRoaXMKICAgICAgLy8g5aaC5p6c5rKh5pyJY2hlY2vov4fvvIzljYrpgInoioLngrnmmK/mi7/kuI3liLDnmoTvvIzlj6rog73pgJrov4fpooTlhYjorr7nva7nmoRwaWRTZXTojrflj5YKICAgICAgY29uc3QgY2hlY2tlZEFsbCA9IHRoaXMudHJlZUNoZWNrCiAgICAgICAgPyBfdGhpcy5jaGVja2VkS2V5cy5jb25jYXQoX3RoaXMuaGFsZkNoZWNrZWRLZXlzKQogICAgICAgIDogX3RoaXMuY2hlY2tlZEtleXMuY29uY2F0KEFycmF5LmZyb20oX3RoaXMucGlkU2V0KSkKICAgICAgLy8gaWYgKCFjaGVja2VkQWxsLmxlbmd0aCA+IDApIHsKICAgICAgLy8gICBfdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor7foh7PlsJHpgInmi6nkuIDkuKrmnYPpmZAnKQogICAgICAvLyAgIHJldHVybgogICAgICAvLyB9CiAgICAgIHRoaXMuZm9ybS52YWxpZGF0ZUZpZWxkcygoZXJyLCB2YWx1ZXMpID0+IHsKICAgICAgICBpZiAoIWVycikgewogICAgICAgICAgaWYgKHRoaXMuJHJlZnMudXBsb2FkLnNGaWxlTGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHZhbHVlcy5tZW51SWRzID0gY2hlY2tlZEFsbAogICAgICAgICAgICB2YWx1ZXMuaWQgPSB2YWx1ZXMuaWQgPT09IDAgPyAnJyA6IHZhbHVlcy5pZAogICAgICAgICAgICB0aGlzLmNvbmZpcm1Mb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICBzYXZlU3lzVG9wTWVudSh2YWx1ZXMpCiAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMCkgewogICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+S/neWtmOaIkOWKnycpCiAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ29rJykKICAgICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfns7vnu5/plJnor6/vvIzor7fnqI3lkI7lho3or5UnKQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5jb25maXJtTG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgfSkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+S4iuS8oOiPnOWNleWbvuaghycpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIC8qCiAgICAgICdzZWxlY3RlZFJvd3MnOiBmdW5jdGlvbiAoc2VsZWN0ZWRSb3dzKSB7CiAgICAgICAgdGhpcy5uZWVkVG90YWxMaXN0ID0gdGhpcy5uZWVkVG90YWxMaXN0Lm1hcChpdGVtID0+IHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLml0ZW0sCiAgICAgICAgICAgIHRvdGFsOiBzZWxlY3RlZFJvd3MucmVkdWNlKCAoc3VtLCB2YWwpID0+IHsKICAgICAgICAgICAgICByZXR1cm4gc3VtICsgdmFsW2l0ZW0uZGF0YUluZGV4XQogICAgICAgICAgICB9LCAwKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0KICAgICAgKi8KICB9Cn0K"},{"version":3,"sources":["SysTopMenuModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmKA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SysTopMenuModal.vue","sourceRoot":"src/views/system/modules","sourcesContent":["<template>\n  <a-modal title=\"操作\"\n           style=\"top: 20px;\"\n           :width=\"1000\"\n           v-model=\"visible\"\n           :bodyStyle=\"{ height: '600px',padding: 0 }\"\n           :confirmLoading=\"confirmLoading\"\n           @ok=\"handleSubmit\">\n    <venus-scroll :only-show-bar-on-scroll=\"false\">\n      <div style=\"padding: 24px\">\n        <a-form :form=\"form\">\n          <a-row :gutter=\"64\">\n            <a-col :span=\"12\"\n                   style=\"border-right: 1px solid #eaeaea\">\n              <div class=\"modal-divider-text\">基本配置</div>\n              <a-form-item style=\"display:none\">\n                <a-input v-decorator=\"['id']\" />\n              </a-form-item>\n              <a-form-item style=\"display:none\">\n                <a-input v-decorator=\"['icon']\" />\n              </a-form-item>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"主菜单名称\">\n                <a-input placeholder=\"主菜单名称\"\n                         v-decorator=\"['name',{rules: [{ required: true, message: '请输入主菜单名称' }]}]\" />\n              </a-form-item>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"是否显示\">\n                <a-select v-decorator=\"['visible', {initialValue:'0',rules: [{ required: true, message: '是否显示' }]}]\">\n                  <a-select-option v-for=\"(b, index) in visibleArry\"\n                                   :key=\"index\"\n                                   :value=\"b.dictValue\">{{ b.dictLabel }}</a-select-option>\n                </a-select>\n              </a-form-item>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"菜单图标\">\n                <!-- <a-input placeholder=\"菜单图标\" v-decorator=\"['icon']\" /> -->\n                <s-upload list-type=\"picture\"\n                          accept-type=\"jpeg,png,svg+xml,ico\"\n                          max-size=\"20\"\n                          max-length=\"1\"\n                          ref=\"upload\"\n                          @success=\"uploadSuccess\"\n                          is-open=\"true\"\n                          v-decorator=\"['assignedId',{initialValue: '',rules: [{ required: true, message: '请上传菜单图标' }]}]\" />\n              </a-form-item>\n              <!-- <a-form-item :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\" label=\"权限标识\">\n        <a-input placeholder=\"权限标识\" v-decorator=\"['perms']\" />\n              </a-form-item>-->\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"主菜单排序\">\n                <a-input-number v-decorator=\"['orderNum',{initialValue:1,rules: [{ required: true, message: '请输入顺序数字' }]}]\"\n                                placeholder=\"显示顺序\" />\n              </a-form-item>\n              <div class=\"modal-divider-text\">首页配置</div>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"首页唯一标识\">\n                <a-input placeholder=\"唯一标识\"\n                         v-decorator=\"['code']\" />\n              </a-form-item>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"首页地址\">\n                <a-input placeholder=\"首页地址\"\n                         v-decorator=\"['component']\" />\n              </a-form-item>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"首页名称\">\n                <a-input placeholder=\"首页名称\"\n                         v-decorator=\"['source']\" />\n              </a-form-item>\n              <div class=\"modal-divider-text\">链接配置</div>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"打开方式\">\n                <a-select v-decorator=\"['target', {initialValue:'',rules: [{ required: false, message: '请选择打开方式' },{validator: validatePathTarget}]}]\">\n                  <a-select-option :value=\"''\">当前窗口</a-select-option>\n                  <a-select-option :value=\"'_blank'\">新窗口</a-select-option>\n                </a-select>\n              </a-form-item>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\">\n                <span slot=\"label\">链接地址</span>\n                <a-input placeholder=\"路径\"\n                         v-decorator=\"['redirect',{\n                           rules: [\n                             { required: false,type:'string', message: '请输入正确的路径' }\n                           ]\n                         }]\" />\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"12\">\n              <div class=\"modal-divider-text\">布局配置</div>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"导航模式\">\n                <a-select @change=\"layoutModeChange\"\n                          v-decorator=\"['layoutMode', {initialValue:'sidemenu',rules: [{ required: true, message: '请选择导航模式' }]}]\">\n                  <a-select-option v-for=\"(b, index) in layoutModeArry\"\n                                   :key=\"index\"\n                                   :value=\"b.dictValue\">{{ b.dictLabel }}</a-select-option>\n                </a-select>\n              </a-form-item>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"多页签模式\">\n                <a-switch :disabled=\"layoutMode === 'topmenu'\"\n                          v-decorator=\"['multiTab',{initialValue: true,valuePropName: 'checked',rules: [{ required: true, message: '请选择多页签模式' }]}]\" />\n              </a-form-item>\n              <div class=\"modal-divider-text\">权限配置</div>\n              <a-form-item :labelCol=\"labelCol\"\n                           :wrapperCol=\"wrapperCol\"\n                           label=\"拥有权限\">\n                <a-tree checkable\n                        v-model=\"checkedKeys\"\n                        @check=\"onCheck\"\n                        :treeData=\"permissions\"></a-tree>\n              </a-form-item>\n            </a-col>\n          </a-row>\n        </a-form>\n        <div class=\"modal-divider-text\">配置说明</div>\n        <div style=\"margin-left: 24px\">\n          <detail-list size=\"small\"\n                       :col=\"2\"\n                       class=\"detail-list-info\">\n            <detail-list-item term=\"唯一标识\">主菜单的唯一标识，如：system;</detail-list-item>\n            <detail-list-item term=\"首页地址\">每个主菜单的欢迎页地址;</detail-list-item>\n          </detail-list>\n          <detail-list size=\"small\"\n                       :col=\"2\"\n                       class=\"detail-list-info\">\n            <detail-list-item term=\"首页名称\">为多页签模式情况下，页签显示的名称；</detail-list-item>\n            <detail-list-item term=\"打开方式\">点击菜单后在当前窗口或者在新窗口跳转路由；</detail-list-item>\n          </detail-list>\n          <detail-list size=\"small\"\n                       :col=\"1\"\n                       class=\"detail-list-info\">\n            <detail-list-item term=\"链接地址\">跳转路由的URL地址，为外部链接地址时，必须设置“打开方式”为新窗口；</detail-list-item>\n          </detail-list>\n          <detail-list size=\"small\"\n                       :col=\"2\"\n                       class=\"detail-list-info\">\n            <detail-list-item term=\"导航模式\">主菜单下的菜单为侧边栏导航或顶部栏导航布局；</detail-list-item>\n            <detail-list-item term=\"拥有权限\">分配主菜单下的菜单；</detail-list-item>\n          </detail-list>\n          <detail-list size=\"small\"\n                       :col=\"1\"\n                       class=\"detail-list-info\">\n            <detail-list-item term=\"多页签模式\">主菜单下的菜单设置是否为多页签路由布局模式，导航模式为“顶部栏导航”时，必须为<span style=\"color: #faad14\">单页签模式</span>；</detail-list-item>\n          </detail-list>\n        </div>\n      </div>\n    </venus-scroll>\n  </a-modal>\n</template>\n<script>\nimport { getPermissions, getMenuPermIds, saveSysTopMenu } from '@/api/system'\nimport pick from 'lodash.pick'\nimport { getDictArray } from '@/utils/dict'\nimport SUpload from '@/components/pts/Upload'\nimport VenusScroll from '@/components/pts/Scroll'\nimport DetailList from '@/components/tools/DetailList'\nconst DetailListItem = DetailList.Item\n\nexport default {\n  name: 'SysTopMenuModal',\n  props: {},\n  components: {\n    SUpload,\n    DetailList,\n    DetailListItem,\n    VenusScroll\n  },\n  data() {\n    return {\n      visible: false,\n      labelCol: {\n        xs: { span: 24 },\n        sm: { span: 6 }\n      },\n      wrapperCol: {\n        xs: { span: 24 },\n        sm: { span: 18 }\n      },\n      confirmLoading: false,\n      mdl: {},\n      layoutModeArry: [],\n      visibleArry: [],\n      form: this.$form.createForm(this),\n      permissions: [],\n      treeCheck: false,\n      pidSet: [],\n      checkedKeys: [],\n      halfCheckedKeys: [],\n      layoutMode: ''\n    }\n  },\n  beforeCreate() { },\n  async created() {\n    this.layoutModeArry = await getDictArray('layout_mode')\n    this.visibleArry = await getDictArray('sys_show_hide')\n    this.loadPermissions()\n  },\n  methods: {\n    layoutModeChange(value) {\n      this.layoutMode = value\n      if (value === 'topmenu') {\n        this.form.setFieldsValue({ multiTab: false })\n      }\n    },\n    add() {\n      this.form.resetFields()\n      this.checkedKeys = []\n      this.pidSet = []\n      this.edit({ id: 0 })\n    },\n    edit(record) {\n      this.layoutMode = ''\n      if (record.id !== 0) {\n        getMenuPermIds(record.id).then(res => {\n          const pidSet = new Set(res.map(m => m.parentId).filter(id => id > 0))\n          this.pidSet = pidSet\n          // 因为antd 树插件勾选父节点会导致所有子节点选中,所以过滤所有父节点\n          this.checkedKeys = res.map(m => m.menuId).filter(id => !pidSet.has(id))\n        })\n      }\n      this.mdl = Object.assign(record)\n      this.mdl.multiTab = this.mdl.multiTab === 'true' || this.mdl.multiTab === true || this.mdl.multiTab === undefined\n      this.mdl.assignedId = this.mdl.busId || null\n      this.treeCheck = false\n      this.visible = true\n      this.$nextTick(() => {\n        this.form.setFieldsValue(\n          pick(\n            this.mdl,\n            'id',\n            'code',\n            'name',\n            'component',\n            'source',\n            'target',\n            // 'perms',\n            'icon',\n            'redirect',\n            'visible',\n            'layoutMode',\n            'multiTab',\n            'orderNum',\n            'assignedId'\n          )\n        )\n      })\n    },\n    validatePathTarget(rule, value, callback) {\n      const redirect = this.form.getFieldValue('redirect')\n      if (redirect && redirect.startsWith('http') && value !== '_blank') {\n        callback(new Error('链接地址为外链时，打开方式必须为新窗口（antd限制）'))\n      } else {\n        callback()\n      }\n    },\n    onCheck(checkedKeys, info) {\n      if (!this.treeCheck) this.treeCheck = true\n      this.checkedKeys = checkedKeys\n      this.halfCheckedKeys = info.halfCheckedKeys\n    },\n    loadPermissions() {\n      getPermissions().then(res => {\n        this.buildtree(res.rows, this.permissions, 0)\n      })\n    },\n    buildtree(list, permissions, parentId) {\n      list.forEach(item => {\n        if (item.parentId === parentId) {\n          var child = {\n            key: item.menuId,\n            title: item.menuName,\n            children: []\n          }\n          this.buildtree(list, child.children, item.menuId)\n          permissions.push(child)\n        }\n      })\n    },\n    uploadSuccess(res) {\n      // console.log(res.filePath)\n      this.form.setFieldsValue({ icon: res.filePath })\n    },\n    handleSubmit(e) {\n      e.preventDefault()\n      const _this = this\n      // 如果没有check过，半选节点是拿不到的，只能通过预先设置的pidSet获取\n      const checkedAll = this.treeCheck\n        ? _this.checkedKeys.concat(_this.halfCheckedKeys)\n        : _this.checkedKeys.concat(Array.from(_this.pidSet))\n      // if (!checkedAll.length > 0) {\n      //   _this.$message.warning('请至少选择一个权限')\n      //   return\n      // }\n      this.form.validateFields((err, values) => {\n        if (!err) {\n          if (this.$refs.upload.sFileList.length > 0) {\n            values.menuIds = checkedAll\n            values.id = values.id === 0 ? '' : values.id\n            this.confirmLoading = true\n            saveSysTopMenu(values)\n              .then(res => {\n                if (res.code === 0) {\n                  this.$message.success('保存成功')\n                  this.$emit('ok')\n                  this.visible = false\n                } else {\n                  this.$message.error(res.msg)\n                }\n              })\n              .catch(() => {\n                this.$message.error('系统错误，请稍后再试')\n              })\n              .finally(() => {\n                this.confirmLoading = false\n              })\n          } else {\n            this.$message.error('请上传菜单图标')\n          }\n        }\n      })\n    }\n  },\n  watch: {\n    /*\n      'selectedRows': function (selectedRows) {\n        this.needTotalList = this.needTotalList.map(item => {\n          return {\n            ...item,\n            total: selectedRows.reduce( (sum, val) => {\n              return sum + val[item.dataIndex]\n            }, 0)\n          }\n        })\n      }\n      */\n  }\n}\n</script>\n<style lang=\"less\">\n.detail-list-info {\n  .term {\n    color: #d2000099 !important;\n    padding-bottom: 6px !important;\n  }\n  .content {\n    color: #a5a4a4 !important;\n    padding-bottom: 6px !important;\n  }\n}\n</style>\n"]}]}