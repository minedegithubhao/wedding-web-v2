{"remainingRequest":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/src/components/pts/WebShell/MultiTab.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/src/components/pts/WebShell/MultiTab.vue","mtime":1605568762426},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cxdpc/WorkSpaces/idea_workspace/wedding-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBUZXJtaW5hbCBmcm9tICcuL3Rlcm1pbmFsJwppbXBvcnQgeyBjbG9uZURlZXAgfSBmcm9tICdsb2Rhc2gnCmltcG9ydCB7IGNyZWF0ZVV1aWQgfSBmcm9tICdAL3V0aWxzL3V0aWwuanMnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1NoZWxsTXVsdGlUYWInLAogIHByb3BzOiB7CiAgICBzaG93RHJhd2VyOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgZHJhd2VyV2lkdGg6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnMTg1cHgnCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAga2V5TGlzdDogW10sCiAgICAgIHBhZ2VzOiBbXSwKICAgICAgYWN0aXZlS2V5OiAnJywKICAgICAgaW5kZXhQYWdlOiB7fQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICB9LAogIG1ldGhvZHM6IHsKICAgIG9wZW4oc2Vzc2lvbikgewogICAgICBjb25zdCBsaW5rID0gY2xvbmVEZWVwKHNlc3Npb24pCiAgICAgIGNvbnN0IHBhZ2VzID0gdGhpcy5wYWdlcy5maWx0ZXIocGFnZSA9PiBwYWdlLmlkID09PSBsaW5rLmlkKQogICAgICBsaW5rLmtleSA9IGNyZWF0ZVV1aWQoKQogICAgICBpZiAocGFnZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5wYWdlcy5wdXNoKGxpbmspCiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGluay5uYW1lID0gYCR7bGluay5uYW1lfSgke3BhZ2VzLmxlbmd0aCArIDF9KWAKICAgICAgICB0aGlzLnBhZ2VzLnB1c2gobGluaykKICAgICAgfQogICAgICB0aGlzLmtleUxpc3QucHVzaChsaW5rLmtleSkKICAgICAgdGhpcy5hY3RpdmVLZXkgPSBsaW5rLmtleQogICAgfSwKICAgIGNsb3NlKGlkKSB7CiAgICAgIGNvbnN0IHBhZ2VzID0gdGhpcy5wYWdlcy5maWx0ZXIocGFnZSA9PiBwYWdlLmlkID09PSBpZCkKICAgICAgcGFnZXMuZm9yRWFjaChwYWdlID0+IHsKICAgICAgICB0aGlzLnJlbW92ZShwYWdlLmtleSkKICAgICAgfSkKICAgIH0sCiAgICBvbkVkaXQodGFyZ2V0S2V5LCBhY3Rpb24pIHsKICAgICAgdGhpc1thY3Rpb25dKHRhcmdldEtleSkKICAgIH0sCiAgICByZW1vdmUodGFyZ2V0S2V5KSB7CiAgICAgIHRoaXMucGFnZXMgPSB0aGlzLnBhZ2VzLmZpbHRlcihwYWdlID0+IHBhZ2Uua2V5ICE9PSB0YXJnZXRLZXkpCiAgICAgIHRoaXMua2V5TGlzdCA9IHRoaXMua2V5TGlzdC5maWx0ZXIocGF0aCA9PiBwYXRoICE9PSB0YXJnZXRLZXkpCiAgICAgIC8vIOWIpOaWreW9k+WJjeagh+etvuaYr+WQpuWFs+mXre+8jOiLpeWFs+mXreWImei3s+i9rOWIsOacgOWQjuS4gOS4qui/mOWtmOWcqOeahOagh+etvumhtQogICAgICBpZiAoIXRoaXMua2V5TGlzdC5pbmNsdWRlcyh0aGlzLmFjdGl2ZUtleSkpIHsKICAgICAgICB0aGlzLnNlbGVjdGVkTGFzdFBhdGgoKQogICAgICB9CiAgICB9LAogICAgc2VsZWN0ZWRMYXN0UGF0aCgpIHsKICAgICAgdGhpcy5hY3RpdmVLZXkgPSB0aGlzLmtleUxpc3RbdGhpcy5rZXlMaXN0Lmxlbmd0aCAtIDFdCiAgICB9LAogICAgY2xvc2VDb25uZWN0KGUpIHsKICAgICAgY29uc3QgcGFnZXMgPSB0aGlzLnBhZ2VzLmZpbHRlcihwYWdlID0+IHBhZ2Uua2V5ID09PSBlKQogICAgICBwYWdlcy5mb3JFYWNoKHBhZ2UgPT4gewogICAgICAgIHRoaXMuY2xvc2UocGFnZS5pZCkKICAgICAgfSkKICAgIH0sCgogICAgLy8gY29udGVudCBtZW51CiAgICBjbG9zZVRoYXQoZSkgewogICAgICB0aGlzLnJlbW92ZShlKQogICAgfSwKICAgIGNsb3NlTGVmdChlKSB7CiAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IHRoaXMua2V5TGlzdC5pbmRleE9mKGUpCiAgICAgIGlmIChjdXJyZW50SW5kZXggPiAwKSB7CiAgICAgICAgdGhpcy5rZXlMaXN0LmZvckVhY2goKGtleSwgaW5kZXgpID0+IHsKICAgICAgICAgIGlmIChpbmRleCA8IGN1cnJlbnRJbmRleCkgewogICAgICAgICAgICB0aGlzLnJlbW92ZShrZXkpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oJ+W3puS+p+ayoeacieS8muivneagh+etvicpCiAgICAgIH0KICAgIH0sCiAgICBjbG9zZVJpZ2h0KGUpIHsKICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gdGhpcy5rZXlMaXN0LmluZGV4T2YoZSkKICAgICAgaWYgKGN1cnJlbnRJbmRleCA8IHRoaXMua2V5TGlzdC5sZW5ndGggLSAxKSB7CiAgICAgICAgdGhpcy5rZXlMaXN0LmZvckVhY2goKGtleSwgaW5kZXgpID0+IHsKICAgICAgICAgIGlmIChpbmRleCA+IGN1cnJlbnRJbmRleCkgewogICAgICAgICAgICB0aGlzLnJlbW92ZShrZXkpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oJ+WPs+S+p+ayoeacieS8muivneagh+etvicpCiAgICAgIH0KICAgIH0sCiAgICBjbG9zZU90aGVyKGUpIHsKICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gdGhpcy5rZXlMaXN0LmluZGV4T2YoZSkKICAgICAgdGhpcy5rZXlMaXN0LmZvckVhY2goKGtleSwgaW5kZXgpID0+IHsKICAgICAgICBpZiAoaW5kZXggIT09IGN1cnJlbnRJbmRleCkgewogICAgICAgICAgdGhpcy5yZW1vdmUoa2V5KQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBjbG9zZUFsbCgpIHsKICAgICAgdGhpcy5rZXlMaXN0LmZvckVhY2goKGtleSwgaW5kZXgpID0+IHsKICAgICAgICB0aGlzLnJlbW92ZShrZXkpCiAgICAgIH0pCiAgICB9LAogICAgY2xvc2VNZW51Q2xpY2soa2V5LCByb3V0ZSkgewogICAgICB0aGlzW2tleV0ocm91dGUpCiAgICB9LAogICAgcmVuZGVyVGFiUGFuZU1lbnUoZSkgewogICAgICByZXR1cm4gKAogICAgICAgIDxhLW1lbnUKICAgICAgICAgIHsuLi57CiAgICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgICAgY2xpY2s6ICh7IGtleSwgaXRlbSwgZG9tRXZlbnQgfSkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5jbG9zZU1lbnVDbGljayhrZXksIGUpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9fQogICAgICAgID4KICAgICAgICAgIDxhLW1lbnUtaXRlbSBrZXk9ImNsb3NlQ29ubmVjdCI+5YWz6Zet5b2T5YmN5Lya6K+dPC9hLW1lbnUtaXRlbT4KICAgICAgICAgIDxhLW1lbnUtaXRlbSBrZXk9ImNsb3NlVGhhdCI+5YWz6Zet5b2T5YmN5Lya6K+d6L+e5o6lPC9hLW1lbnUtaXRlbT4KICAgICAgICAgIDxhLW1lbnUtaXRlbSBrZXk9ImNsb3NlUmlnaHQiPuWFs+mXreWPs+S+p+S8muivnei/nuaOpTwvYS1tZW51LWl0ZW0+CiAgICAgICAgICA8YS1tZW51LWl0ZW0ga2V5PSJjbG9zZVJpZ2h0Ij7lhbPpl63lj7PkvqfkvJror53ov57mjqU8L2EtbWVudS1pdGVtPgogICAgICAgICAgPGEtbWVudS1pdGVtIGtleT0iY2xvc2VMZWZ0Ij7lhbPpl63lt6bkvqfkvJror53ov57mjqU8L2EtbWVudS1pdGVtPgogICAgICAgICAgPGEtbWVudS1pdGVtIGtleT0iY2xvc2VPdGhlciI+5YWz6Zet5YW25a6D5Lya6K+d6L+e5o6lPC9hLW1lbnUtaXRlbT4KICAgICAgICAgIDxhLW1lbnUtaXRlbSBrZXk9ImNsb3NlQWxsIj7lhbPpl63lhajpg6jkvJror53ov57mjqU8L2EtbWVudS1pdGVtPgogICAgICAgIDwvYS1tZW51PgogICAgICApCiAgICB9LAogICAgLy8gcmVuZGVyCiAgICByZW5kZXJUYWJQYW5lKHRpdGxlLCBrZXkpIHsKICAgICAgY29uc3QgbWVudSA9IHRoaXMucmVuZGVyVGFiUGFuZU1lbnUoa2V5KQoKICAgICAgcmV0dXJuICgKICAgICAgICA8YS1kcm9wZG93biBvdmVybGF5PXttZW51fSB0cmlnZ2VyPXtbJ2NvbnRleHRtZW51J119PgogICAgICAgICAgPHNwYW4gc3R5bGU9e3sgdXNlclNlbGVjdDogJ25vbmUnIH19Pnt0aXRsZX08L3NwYW4+CiAgICAgICAgPC9hLWRyb3Bkb3duPgogICAgICApCiAgICB9CiAgfSwKICB3YXRjaDogewogIH0sCiAgcmVuZGVyKCkgewogICAgY29uc3QgewogICAgICBvbkVkaXQsCiAgICAgICRkYXRhOiB7IHBhZ2VzIH0KICAgIH0gPSB0aGlzCiAgICBjb25zdCBwYW5lcyA9IHBhZ2VzLm1hcChwYWdlID0+IHsKICAgICAgcmV0dXJuICgKICAgICAgICA8YS10YWItcGFuZQogICAgICAgICAgdGFiPXt0aGlzLnJlbmRlclRhYlBhbmUocGFnZS5uYW1lLCBwYWdlLmtleSl9CiAgICAgICAgICBrZXk9e3BhZ2Uua2V5fQogICAgICAgICAgY2xvc2FibGU9e3RydWV9CiAgICAgICAgICBmb3JjZVJlbmRlcj17dHJ1ZX0KICAgICAgICA+PFRlcm1pbmFsIHRlcm1EYXRhPXtwYWdlfSBrZXk9e3BhZ2Uua2V5fT48L1Rlcm1pbmFsPjwvYS10YWItcGFuZT4KICAgICAgKQogICAgfSkKCiAgICByZXR1cm4gKAogICAgICA8ZGl2IGNsYXNzPSJzaGVsbC10YWIiIHN0eWxlPXsgYG1hcmdpbkxlZnQ6ICR7IHRoaXMuc2hvd0RyYXdlciA/IHRoaXMuZHJhd2VyV2lkdGggOiAnMHB4JyB9YCB9PgogICAgICAgIDxkaXYgY2xhc3M9InNoZWxsLXRhYi13cmFwcGVyIj4KICAgICAgICAgIDxhLXRhYnMKICAgICAgICAgICAgaGlkZUFkZAogICAgICAgICAgICBzaXplPSJzbWFsbCIKICAgICAgICAgICAgdHlwZT17J2VkaXRhYmxlLWNhcmQnfQogICAgICAgICAgICB2LW1vZGVsPXt0aGlzLmFjdGl2ZUtleX0KICAgICAgICAgICAgdGFiQmFyU3R5bGU9e3sgYmFja2dyb3VuZDogJyMzYjNiM2InLCBoZWlnaHQ6ICczNXB4JywgbWFyZ2luOiAwLCBwYWRkaW5nTGVmdDogJzhweCcsIHBhZGRpbmdUb3A6ICcxcHgnIH19CiAgICAgICAgICAgIHsuLi57IG9uOiB7IGVkaXQ6IG9uRWRpdCB9IH19CiAgICAgICAgICA+CiAgICAgICAgICAgIHtwYW5lc30KICAgICAgICAgIDwvYS10YWJzPgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgICkKICB9Cn0K"},{"version":3,"sources":["MultiTab.vue"],"names":[],"mappings":";AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MultiTab.vue","sourceRoot":"src/components/pts/WebShell","sourcesContent":["<script>\nimport Terminal from './terminal'\nimport { cloneDeep } from 'lodash'\nimport { createUuid } from '@/utils/util.js'\n\nexport default {\n  name: 'ShellMultiTab',\n  props: {\n    showDrawer: {\n      type: Boolean,\n      default: false\n    },\n    drawerWidth: {\n      type: String,\n      default: '185px'\n    }\n  },\n  data() {\n    return {\n      keyList: [],\n      pages: [],\n      activeKey: '',\n      indexPage: {}\n    }\n  },\n  created() {\n  },\n  methods: {\n    open(session) {\n      const link = cloneDeep(session)\n      const pages = this.pages.filter(page => page.id === link.id)\n      link.key = createUuid()\n      if (pages.length === 0) {\n        this.pages.push(link)\n      } else {\n        link.name = `${link.name}(${pages.length + 1})`\n        this.pages.push(link)\n      }\n      this.keyList.push(link.key)\n      this.activeKey = link.key\n    },\n    close(id) {\n      const pages = this.pages.filter(page => page.id === id)\n      pages.forEach(page => {\n        this.remove(page.key)\n      })\n    },\n    onEdit(targetKey, action) {\n      this[action](targetKey)\n    },\n    remove(targetKey) {\n      this.pages = this.pages.filter(page => page.key !== targetKey)\n      this.keyList = this.keyList.filter(path => path !== targetKey)\n      // 判断当前标签是否关闭，若关闭则跳转到最后一个还存在的标签页\n      if (!this.keyList.includes(this.activeKey)) {\n        this.selectedLastPath()\n      }\n    },\n    selectedLastPath() {\n      this.activeKey = this.keyList[this.keyList.length - 1]\n    },\n    closeConnect(e) {\n      const pages = this.pages.filter(page => page.key === e)\n      pages.forEach(page => {\n        this.close(page.id)\n      })\n    },\n\n    // content menu\n    closeThat(e) {\n      this.remove(e)\n    },\n    closeLeft(e) {\n      const currentIndex = this.keyList.indexOf(e)\n      if (currentIndex > 0) {\n        this.keyList.forEach((key, index) => {\n          if (index < currentIndex) {\n            this.remove(key)\n          }\n        })\n      } else {\n        this.$message.info('左侧没有会话标签')\n      }\n    },\n    closeRight(e) {\n      const currentIndex = this.keyList.indexOf(e)\n      if (currentIndex < this.keyList.length - 1) {\n        this.keyList.forEach((key, index) => {\n          if (index > currentIndex) {\n            this.remove(key)\n          }\n        })\n      } else {\n        this.$message.info('右侧没有会话标签')\n      }\n    },\n    closeOther(e) {\n      const currentIndex = this.keyList.indexOf(e)\n      this.keyList.forEach((key, index) => {\n        if (index !== currentIndex) {\n          this.remove(key)\n        }\n      })\n    },\n    closeAll() {\n      this.keyList.forEach((key, index) => {\n        this.remove(key)\n      })\n    },\n    closeMenuClick(key, route) {\n      this[key](route)\n    },\n    renderTabPaneMenu(e) {\n      return (\n        <a-menu\n          {...{\n            on: {\n              click: ({ key, item, domEvent }) => {\n                this.closeMenuClick(key, e)\n              }\n            }\n          }}\n        >\n          <a-menu-item key=\"closeConnect\">关闭当前会话</a-menu-item>\n          <a-menu-item key=\"closeThat\">关闭当前会话连接</a-menu-item>\n          <a-menu-item key=\"closeRight\">关闭右侧会话连接</a-menu-item>\n          <a-menu-item key=\"closeRight\">关闭右侧会话连接</a-menu-item>\n          <a-menu-item key=\"closeLeft\">关闭左侧会话连接</a-menu-item>\n          <a-menu-item key=\"closeOther\">关闭其它会话连接</a-menu-item>\n          <a-menu-item key=\"closeAll\">关闭全部会话连接</a-menu-item>\n        </a-menu>\n      )\n    },\n    // render\n    renderTabPane(title, key) {\n      const menu = this.renderTabPaneMenu(key)\n\n      return (\n        <a-dropdown overlay={menu} trigger={['contextmenu']}>\n          <span style={{ userSelect: 'none' }}>{title}</span>\n        </a-dropdown>\n      )\n    }\n  },\n  watch: {\n  },\n  render() {\n    const {\n      onEdit,\n      $data: { pages }\n    } = this\n    const panes = pages.map(page => {\n      return (\n        <a-tab-pane\n          tab={this.renderTabPane(page.name, page.key)}\n          key={page.key}\n          closable={true}\n          forceRender={true}\n        ><Terminal termData={page} key={page.key}></Terminal></a-tab-pane>\n      )\n    })\n\n    return (\n      <div class=\"shell-tab\" style={ `marginLeft: ${ this.showDrawer ? this.drawerWidth : '0px' }` }>\n        <div class=\"shell-tab-wrapper\">\n          <a-tabs\n            hideAdd\n            size=\"small\"\n            type={'editable-card'}\n            v-model={this.activeKey}\n            tabBarStyle={{ background: '#3b3b3b', height: '35px', margin: 0, paddingLeft: '8px', paddingTop: '1px' }}\n            {...{ on: { edit: onEdit } }}\n          >\n            {panes}\n          </a-tabs>\n        </div>\n      </div>\n    )\n  }\n}\n</script>\n<style lang=\"less\">\n.shell-tab {\n  transition: all 0.4s ease 0s;\n  .shell-tab-wrapper {\n    .ant-tabs-bar {\n      border-bottom-color: #616161;\n      .ant-tabs-nav-container {\n        height: 35px;\n        .ant-tabs-nav-wrap {\n          .ant-tabs-nav {\n            .ant-tabs-tab {\n              height: 34px;\n              line-height: 33px;\n              background: #e5e5e5;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n"]}]}